@using Microsoft.AspNetCore.Components.Web

@if (HasError)
{
    <div class="alert alert-danger" role="alert">
        <h4 class="alert-heading">An error occurred</h4>
        <p>@ErrorMessage</p>
        <hr>
        <p class="mb-0">Please refresh the page or contact support if the problem persists.</p>
        <button class="btn btn-outline-danger mt-2" @onclick="Reset">Try Again</button>
    </div>
}
else
{
    @ChildContent
}

@code {
    [Parameter] public RenderFragment? ChildContent { get; set; }

    private bool HasError { get; set; }
    private string ErrorMessage { get; set; } = string.Empty;

    public void Recover()
    {
        HasError = false;
        ErrorMessage = string.Empty;
        StateHasChanged();
    }

    protected override void OnInitialized()
    {
        HasError = false;
    }

    public void Reset()
    {
        Recover();
    }

    protected override void OnParametersSet()
    {
        // Reset error state when parameters change
        HasError = false;
        ErrorMessage = string.Empty;
    }

    public void HandleException(Exception exception)
    {
        HasError = true;
        ErrorMessage = exception.Message;
        StateHasChanged();
    }
}